(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31025,        846]
NotebookOptionsPosition[     28968,        802]
NotebookOutlinePosition[     29324,        818]
CellTagsIndexPosition[     29281,        815]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"xx", "=", 
  RowBox[{
   RowBox[{"First", "[", 
    RowBox[{"DSolve", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"\[Beta]", " ", 
              RowBox[{"x", "[", "t", "]"}]}], "+", 
             RowBox[{"\[Alpha]", 
              FractionBox[
               RowBox[{" ", "kSR"}], 
               RowBox[{"\[Nu]", " ", "a", " ", "VPD"}]], " ", 
              RowBox[{"x", "[", "t", "]"}], " ", "VPD"}]}], "1"]}]}], ",", 
         RowBox[{
          RowBox[{"x", "[", "T", "]"}], "\[Equal]", 
          RowBox[{"x0", "/", "100"}]}]}], "}"}], "]"}], "\[IndentingNewLine]",
       ",", 
      RowBox[{"x", "[", "t", "]"}], ",", "t"}], "]"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.745863233833856*^9, 3.745863238934869*^9}, {
  3.745863307791911*^9, 3.7458633209843073`*^9}, {3.745864109218568*^9, 
  3.745864110788232*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"1a76a86b-6704-4ec7-84bd-bf33ca3c75c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "[", "t", "]"}], "\[Rule]", 
   RowBox[{
    FractionBox["1", "100"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t", "-", "T"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kSR", " ", "\[Alpha]"}], "+", 
          RowBox[{"a", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}], 
       RowBox[{"a", " ", "\[Nu]"}]]}]], " ", "x0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.745862883732376*^9, 3.7458632396448927`*^9, {3.745863316927799*^9, 
   3.745863321409191*^9}, 3.7458641152076263`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"2abe4143-7889-4893-b56b-f220ef58d716"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"constants", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", "\[Rule]", "20"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "0.001"}], ",", 
     RowBox[{"VPD", "\[Rule]", "0.015"}], ",", 
     RowBox[{"k", "\[Rule]", 
      RowBox[{"0.05", "*", "24", "*", "3600"}]}], ",", 
     RowBox[{"x0", "\[Rule]", "0.8"}], ",", 
     RowBox[{"Zr", "\[Rule]", "0.3"}], ",", 
     RowBox[{"ca", "\[Rule]", "350*^-6"}], ",", 
     RowBox[{"a", "\[Rule]", "1.6"}], ",", 
     RowBox[{"n", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\[Nu]", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"5", "*", "0.018", "*", "0.5"}], ")"}], "/", "1000"}]}], ",", 
     
     RowBox[{"kSR", "\[Rule]", "0.01"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7458641559832153`*^9, 3.7458641633837337`*^9}, 
   3.745864241589705*^9, 3.745864689674322*^9},
 CellLabel->
  "In[173]:=",ExpressionUUID->"cf2b8faf-27d9-4dd3-a42d-b61a207907a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", "[", "t", "]"}], "/.", "optg"}], ")"}], "\[Equal]", 
    RowBox[{"g", "[", "t", "]"}]}], ",", 
   RowBox[{"\[Lambda]", "[", "t", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.745862973674882*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"e0ed4c7d-c19c-4f64-ad97-8247e20f3afd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Lambda]", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"ca", " ", 
      SuperscriptBox["k", "2"]}], 
     RowBox[{"VPD", " ", "\[Alpha]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"k", "+", 
         RowBox[{"g", "[", "t", "]"}]}], ")"}], "2"]}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7458629748117533`*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"4cf2f3b6-4b6a-492a-a235-e1967843fa82"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lam", "=", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Lambda]", "'"}], "[", "t", "]"}], "\[Equal]", " ", 
       FractionBox[
        RowBox[{
         RowBox[{"\[Lambda]", "[", "t", "]"}], " ", "\[Beta]", " "}], "1"]}], 
      ",", 
      RowBox[{
       RowBox[{"\[Lambda]", "[", "0", "]"}], "\[Equal]", "\[Lambda]0"}]}], 
     "}"}], ",", 
    RowBox[{"\[Lambda]", "[", "t", "]"}], ",", "t"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.74586309767726*^9, 3.745863132495913*^9}, {
  3.745863508367597*^9, 3.745863510850202*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"3f9559bb-11de-47b9-a892-7ee40f29b609"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Lambda]", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"t", " ", "\[Beta]"}]], " ", "\[Lambda]0"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7458631161273108`*^9, 3.745863133066905*^9}, 
   3.7458635204757223`*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"cc7d8af4-b16e-4f7d-a572-2373e6bfc942"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"g", "[", "t", "]"}], "/.", "optg"}], "/.", "lam"}], "/.", 
        RowBox[{"t", "\[Rule]", "T"}]}], ")"}], "==", 
      RowBox[{
       FractionBox[
        RowBox[{" ", "kSR"}], 
        RowBox[{"\[Nu]", " ", "a", " ", "VPD"}]], " ", 
       FractionBox["x0", "100"]}]}], ",", "\[Lambda]0"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "\[Rule]", 
      FractionBox["\[Gamma]", 
       RowBox[{"n", " ", "Zr"}]]}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Nu]", " ", "a"}], 
       RowBox[{"n", " ", "Zr"}]]}]}], "}"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"T", "\[Rule]", "20"}], ",", 
    RowBox[{"\[Gamma]", "\[Rule]", "0.001"}], ",", 
    RowBox[{"VPD", "\[Rule]", "0.015"}], ",", 
    RowBox[{"k", "\[Rule]", 
     RowBox[{"0.05", "*", "24", "*", "3600"}]}], ",", 
    RowBox[{"x0", "\[Rule]", "0.8"}], ",", 
    RowBox[{"Zr", "\[Rule]", "0.3"}], ",", 
    RowBox[{"ca", "\[Rule]", "350*^-6"}], ",", 
    RowBox[{"a", "\[Rule]", "1.6"}], ",", 
    RowBox[{"n", "\[Rule]", "0.5"}], ",", 
    RowBox[{"\[Nu]", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"5", "*", "0.018", "*", "0.5"}], ")"}], "/", "1000"}]}], ",", 
    RowBox[{"kSR", "\[Rule]", "0.01"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.745863466040271*^9, 3.7458635658838*^9}, {
  3.7458636199140253`*^9, 3.745863692811018*^9}, {3.745863926152317*^9, 
  3.745863931122609*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"5817d830-58eb-4125-8796-ebad8da2f2ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Lambda]0", "\[Rule]", "41.120876475666584`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7458634972068043`*^9, 3.745863566965207*^9}, 
   3.745863634215818*^9, {3.745863673051836*^9, 3.745863702189488*^9}, {
   3.745863736400928*^9, 3.745863752707553*^9}, {3.745863926550404*^9, 
   3.745863936958436*^9}},
 CellLabel->
  "Out[156]=",ExpressionUUID->"9279ab45-1e15-4cf4-b20e-52a0f27e6b88"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[Lambda]0", "/.", "%"}], ")"}], "*", 
   FractionBox["\[Nu]", 
    RowBox[{"n", " ", "Zr"}]], "*", 
   SuperscriptBox["10", "3"]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"T", "\[Rule]", "20"}], ",", 
    RowBox[{"\[Gamma]", "\[Rule]", "0.001"}], ",", 
    RowBox[{"VPD", "\[Rule]", "0.015"}], ",", 
    RowBox[{"k", "\[Rule]", 
     RowBox[{"0.05", "*", "24", "*", "3600"}]}], ",", 
    RowBox[{"x0", "\[Rule]", "0.8"}], ",", 
    RowBox[{"Zr", "\[Rule]", "0.3"}], ",", 
    RowBox[{"ca", "\[Rule]", "350*^-6"}], ",", 
    RowBox[{"a", "\[Rule]", "1.6"}], ",", 
    RowBox[{"n", "\[Rule]", "0.5"}], ",", 
    RowBox[{"\[Nu]", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"5", "*", "0.018", "*", "0.5"}], ")"}], "/", "1000"}]}], ",", 
    RowBox[{"kSR", "\[Rule]", "0.01"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7458637071996727`*^9, 3.745863751120818*^9}, {
   3.745863928351272*^9, 3.745863934293399*^9}, 3.745864760472713*^9},
 CellLabel->
  "In[157]:=",ExpressionUUID->"6d6b97fe-b5e3-4a77-8245-e2320a66d216"],

Cell[BoxData[
 RowBox[{"{", "12.336262942699975`", "}"}]], "Output",
 CellChangeTimes->{{3.7458637253010178`*^9, 3.745863753575568*^9}, {
  3.745863929047935*^9, 3.7458639376826353`*^9}},
 CellLabel->
  "Out[157]=",ExpressionUUID->"7afaebc3-994a-4954-ba68-4a24e6a59452"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"lam", ",", "xx", ",", "tStar"}], "]"}]], "Input",
 CellChangeTimes->{{3.745863513018409*^9, 3.745863516594965*^9}, {
  3.7458641136002274`*^9, 3.7458641139600563`*^9}, {3.745865392328745*^9, 
  3.745865393177566*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"40c7c178-04f2-4307-82f1-7ce77ea95562"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Evaluate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", "[", "t", "]"}], "/.", "optg"}], ")"}], "\[Equal]", 
      RowBox[{
       FractionBox["kSR", 
        RowBox[{"\[Nu]", " ", "a", " ", "VPD"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], "/.", "optx"}], ")"}]}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Beta]", "\[Rule]", 
       FractionBox["\[Gamma]", 
        RowBox[{"n", " ", "Zr"}]]}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", 
       FractionBox[
        RowBox[{"\[Nu]", " ", "a"}], 
        RowBox[{"n", " ", "Zr"}]]}], ",", 
      RowBox[{"t", "\[Rule]", "tStar"}]}], "}"}]}], "/.", "constants"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.745864604596369*^9, 3.745864744221592*^9}, {
  3.7458651506165533`*^9, 3.74586515407411*^9}, {3.745865283371641*^9, 
  3.745865385012843*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"97c9942c-c876-4d5d-89c2-f5a5e22db6a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4320.000000000001`", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox["6.972166887783963`", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"0.006666666666666667`", " ", "tStar"}]], " ", 
        "\[Lambda]0"}]]]}], ")"}]}], "\[Equal]", 
  RowBox[{"9259.259259259261`", " ", 
   RowBox[{"(", 
    RowBox[{"4.6656`", "\[VeryThinSpace]", "-", 
     RowBox[{"3.8656000000000006`", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "0.006666666666666667`"}], " ", "tStar"}]]}], "+", 
     FractionBox[
      RowBox[{"65.05868366328973`", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "0.006666666666666667`"}], " ", "tStar"}]]}], 
      SqrtBox["\[Lambda]0"]], "-", 
     FractionBox[
      RowBox[{"65.05868366328973`", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "0.006666666666666667`"}], " ", "tStar"}]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"0.006666666666666667`", " ", "tStar"}]], " ", 
         "\[Lambda]0"}]]}], "\[Lambda]0"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.745864611222109*^9, 3.7458646433767967`*^9, {3.74586469900107*^9, 
   3.7458647446672993`*^9}, 3.745865088822806*^9, 3.7458651546773233`*^9, {
   3.745865309072048*^9, 3.7458653947214327`*^9}},
 CellLabel->
  "Out[188]=",ExpressionUUID->"7a1b6c48-3382-4c2f-b8a5-d7d481c0f9c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"15.872241917359332`", "*", 
   FractionBox["\[Nu]", 
    RowBox[{"n", " ", "Zr"}]], "*", 
   SuperscriptBox["10", "3"]}], "/.", "constants"}]], "Input",
 CellChangeTimes->{{3.7458647654866734`*^9, 3.74586476900568*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"64c44463-2707-4b22-9253-2af5adaf9840"],

Cell[BoxData["4.761672575207799`"], "Output",
 CellChangeTimes->{3.7458647693502417`*^9},
 CellLabel->
  "Out[177]=",ExpressionUUID->"d8b7cca9-8bab-45e3-9171-1591cc18649f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"smLimited", "[", 
   RowBox[{"kSRvalue_", ",", "color_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "constants", ",", "optSols", ",", "tStar", ",", "xPart2", ",", "xSol", 
      ",", "lamSol", ",", "gSol", ",", "kSRvar", ",", "optxLim", ",", 
      "colorvar"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"kSRvar", "=", "kSRvalue"}], ";", 
     RowBox[{"colorvar", "=", "color"}], ";", "\[IndentingNewLine]", 
     RowBox[{"constants", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"T", "\[Rule]", "20"}], ",", 
        RowBox[{"\[Gamma]", "\[Rule]", "0.001"}], ",", 
        RowBox[{"VPD", "\[Rule]", "0.015"}], ",", 
        RowBox[{"k", "\[Rule]", 
         RowBox[{"0.05", "*", "24", "*", "3600"}]}], ",", 
        RowBox[{"x0", "\[Rule]", "0.8"}], ",", 
        RowBox[{"Zr", "\[Rule]", "0.3"}], ",", 
        RowBox[{"ca", "\[Rule]", "350*^-6"}], ",", 
        RowBox[{"a", "\[Rule]", "1.6"}], ",", 
        RowBox[{"n", "\[Rule]", "0.5"}], ",", 
        RowBox[{"\[Nu]", "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"5", "*", "0.018", "*", "0.5"}], ")"}], "/", "1000"}]}], 
        ",", 
        RowBox[{"kSR", "\[Rule]", "kSRvar"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"optSols", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"DSolve", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Lambda]", "'"}], "[", "t", "]"}], "\[Equal]", 
                 " ", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"\[Lambda]", "[", "t", "]"}], " ", "\[Beta]", 
                   " "}], "1"]}], ",", 
                RowBox[{
                 RowBox[{"\[Lambda]", "[", "0", "]"}], "\[Equal]", 
                 "\[Lambda]0"}]}], "}"}], ",", 
              RowBox[{"\[Lambda]", "[", "t", "]"}], ",", "t"}], "]"}], "]"}], 
           "//", "Simplify"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", 
             RowBox[{"DSolve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"ca", " ", 
                   SuperscriptBox[
                    RowBox[{"(", "k", ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", "[", "t", "]"}], "+", "k"}], ")"}], "2"]], 
                 "-", 
                 FractionBox[
                  RowBox[{"\[Alpha]", " ", "VPD", " ", 
                   RowBox[{"\[Lambda]", "[", "t", "]"}]}], "1"]}], "\[Equal]",
                 "0"}], ",", 
               RowBox[{"g", "[", "t", "]"}], " ", ",", "t"}], " ", "]"}], 
             "]"}], "/.", "optLam"}], "//", "Simplify"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"First", "[", 
           RowBox[{"DSolve", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"x", "[", "t", "]"}]}], "+", 
                    RowBox[{"\[Alpha]", " ", 
                    RowBox[{"g", "[", "t", "]"}], "VPD"}]}], "1"]}]}], ",", 
                 RowBox[{
                  RowBox[{"x", "[", "0", "]"}], "\[Equal]", "x0"}]}], "}"}], "/.", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"optg", ",", "optLam"}], "}"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"x", "[", "t", "]"}], ",", "t"}], "]"}], "]"}]}], "}"}], 
        "\[IndentingNewLine]", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Beta]", "\[Rule]", 
           FractionBox["\[Gamma]", 
            RowBox[{"n", " ", "Zr"}]]}], ",", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           FractionBox[
            RowBox[{"\[Nu]", " ", "a"}], 
            RowBox[{"n", " ", "Zr"}]]}]}], "}"}]}], "/.", "constants"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"tStar", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "/.", "sols"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"optxLim", "=", 
      RowBox[{"First", "[", 
       RowBox[{"DSolve", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                RowBox[{"\[Beta]", " ", 
                 RowBox[{"x", "[", "t", "]"}]}], "+", 
                RowBox[{"\[Alpha]", 
                 FractionBox[
                  RowBox[{" ", "kSR"}], 
                  RowBox[{"\[Nu]", " ", "a", " ", "VPD"}]], " ", 
                 RowBox[{"x", "[", "t", "]"}], " ", "VPD"}]}], "1"]}]}], ",", 
            
            RowBox[{
             RowBox[{"x", "[", "ts", "]"}], "\[Equal]", "xts"}]}], "}"}], 
          "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"x", "[", "t", "]"}], ",", "t"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xPart2", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "t", "]"}], "/.", "optxLim"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ts", "\[Rule]", "tStar"}], ",", 
           RowBox[{"xts", "->", 
            RowBox[{"First", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "t", "]"}], "/.", "sols"}], "/.", 
              RowBox[{"t", "\[Rule]", "tStar"}]}], "]"}]}]}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Beta]", "\[Rule]", 
           FractionBox["\[Gamma]", 
            RowBox[{"n", " ", "Zr"}]]}], ",", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           FractionBox[
            RowBox[{"\[Nu]", " ", "a"}], 
            RowBox[{"n", " ", "Zr"}]]}]}], "}"}]}], "/.", "constants"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xSol", "[", "t", "]"}], "=", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             RowBox[{"First", "[", 
              RowBox[{
               RowBox[{"x", "[", "t", "]"}], "/.", "sols"}], "]"}], 
             RowBox[{"t", "<", "tStar"}]},
            {
             RowBox[{"xPart2", "[", "t", "]"}], 
             RowBox[{"t", "\[GreaterEqual]", "tStar"}]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lamSol", "[", "t", "]"}], "=", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{
           RowBox[{"\[Lambda]", "[", "t", "]"}], "/.", "sols"}], 
          RowBox[{"t", "<", "tStar"}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox["a", "2"], " ", "ca", " ", 
               SuperscriptBox["k", "2"], " ", "VPD", " ", 
               SuperscriptBox["\[Nu]", "2"]}], 
              RowBox[{"\[Alpha]", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", "k", " ", "VPD", " ", "\[Nu]"}], "+", 
                  RowBox[{"kSR", " ", 
                   RowBox[{"x", "[", "t", "]"}]}]}], ")"}], "2"]}]], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Beta]", "\[Rule]", 
                FractionBox["\[Gamma]", 
                 RowBox[{"n", " ", "Zr"}]]}], ",", 
               RowBox[{"\[Alpha]", "\[Rule]", 
                FractionBox[
                 RowBox[{"\[Nu]", " ", "a"}], 
                 RowBox[{"n", " ", "Zr"}]]}]}], "}"}]}], "/.", "constants"}], 
           "/.", "sols"}], 
          RowBox[{"t", "\[GreaterEqual]", "tStar"}]}
        }]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gSol", "[", "t", "]"}], "=", 
      RowBox[{"\[Piecewise]", GridBox[{
         {
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"g", "[", "t", "]"}], "/.", "optg"}], "/.", "sols"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Beta]", "\[Rule]", 
                FractionBox["\[Gamma]", 
                 RowBox[{"n", " ", "Zr"}]]}], ",", 
               RowBox[{"\[Alpha]", "\[Rule]", 
                FractionBox[
                 RowBox[{"\[Nu]", " ", "a"}], 
                 RowBox[{"n", " ", "Zr"}]]}]}], "}"}]}], "/.", "constants"}], 
           "//", "First"}], 
          RowBox[{"t", "<", "tStar"}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{" ", "kSR"}], 
              RowBox[{"\[Nu]", " ", "a", " ", "VPD"}]], " ", 
             RowBox[{"xPart2", "[", "t", "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Beta]", "\[Rule]", 
               FractionBox["\[Gamma]", 
                RowBox[{"n", " ", "Zr"}]]}], ",", 
              RowBox[{"\[Alpha]", "\[Rule]", 
               FractionBox[
                RowBox[{"\[Nu]", " ", "a"}], 
                RowBox[{"n", " ", "Zr"}]]}]}], "}"}]}], "/.", "constants"}], 
          RowBox[{"t", "\[GreaterEqual]", "tStar"}]}
        }]}]}], ";", "\n", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"xSol", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "20"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Time (Days)\>\"", ",", "\"\<x(t)\>\""}], "}"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "Medium", "]"}], ",", "Red", ",", 
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"tStar", ",", 
                 RowBox[{
                  RowBox[{"xSol", "[", "t", "]"}], "/.", 
                  RowBox[{"t", "\[Rule]", "tStar"}]}]}], "}"}], "]"}]}], 
             "}"}]}], ","}], "*)"}], 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "colorvar"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"lamSol", "[", "t", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["\[Nu]", 
             RowBox[{"n", " ", "Zr"}]], "/.", "constants"}], ")"}], "*", 
          SuperscriptBox["10", "3"]}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "20"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "15"}], "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Time (Days)\>\"", ",", 
            "\"\<\[Lambda](t) (mmol \!\(\*SuperscriptBox[\(mol\), \
\(-1\)]\))\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "Medium", "]"}], ",", "Red", ",", 
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"tStar", ",", 
                 RowBox[{"First", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"lamSol", "[", "t", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["\[Nu]", 
                    RowBox[{"n", " ", "Zr"}]], "/.", "constants"}], ")"}], 
                    "*", 
                    SuperscriptBox["10", "3"]}], "/.", 
                   RowBox[{"t", "\[Rule]", "tStar"}]}], "]"}]}], "}"}], 
               "]"}]}], "}"}]}], ","}], "*)"}], 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "colorvar"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"gSol", "[", "t", "]"}], 
          RowBox[{"24", "*", "3600"}]], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "20"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Time (Days)\>\"", ",", 
            "\"\<g(t) (mol \!\(\*SuperscriptBox[\(m\), \(-2\)]\) \
\!\(\*SuperscriptBox[\(s\), \(-1\)]\))\>\""}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "Medium", "]"}], ",", "Red", ",", 
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"tStar", ",", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"gSol", "[", "t", "]"}], 
                   RowBox[{"24", "*", "3600"}]], "/.", 
                  RowBox[{"t", "\[Rule]", "tStar"}]}]}], "}"}], "]"}]}], 
             "}"}]}], ","}], "*)"}], 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "colorvar"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.745864848045929*^9, 3.745864858176867*^9}, {
  3.74586490776264*^9, 3.7458649609366503`*^9}, {3.74586499353864*^9, 
  3.7458649976013107`*^9}},ExpressionUUID->"a73a4715-5845-401d-a24e-\
a0398c442aa3"]
},
WindowSize->{1476, 919},
WindowMargins->{{155, Automatic}, {Automatic, 14}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1211, 32, 114, "Input",ExpressionUUID->"1a76a86b-6704-4ec7-84bd-bf33ca3c75c8"],
Cell[1794, 56, 749, 21, 51, "Output",ExpressionUUID->"2abe4143-7889-4893-b56b-f220ef58d716"]
}, Open  ]],
Cell[2558, 80, 964, 24, 30, "Input",ExpressionUUID->"cf2b8faf-27d9-4dd3-a42d-b61a207907a6"],
Cell[CellGroupData[{
Cell[3547, 108, 391, 11, 30, "Input",ExpressionUUID->"e0ed4c7d-c19c-4f64-ad97-8247e20f3afd"],
Cell[3941, 121, 514, 16, 57, "Output",ExpressionUUID->"4cf2f3b6-4b6a-492a-a235-e1967843fa82"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4492, 142, 714, 20, 47, "Input",ExpressionUUID->"3f9559bb-11de-47b9-a892-7ee40f29b609"],
Cell[5209, 164, 431, 12, 37, "Output",ExpressionUUID->"cc7d8af4-b16e-4f7d-a572-2373e6bfc942"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5677, 181, 1699, 47, 72, "Input",ExpressionUUID->"5817d830-58eb-4125-8796-ebad8da2f2ce"],
Cell[7379, 230, 456, 10, 34, "Output",ExpressionUUID->"9279ab45-1e15-4cf4-b20e-52a0f27e6b88"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7872, 245, 1108, 28, 44, "Input",ExpressionUUID->"6d6b97fe-b5e3-4a77-8245-e2320a66d216"],
Cell[8983, 275, 270, 5, 34, "Output",ExpressionUUID->"7afaebc3-994a-4954-ba68-4a24e6a59452"]
}, Open  ]],
Cell[9268, 283, 349, 7, 30, "Input",ExpressionUUID->"40c7c178-04f2-4307-82f1-7ce77ea95562"],
Cell[CellGroupData[{
Cell[9642, 294, 1040, 30, 49, "Input",ExpressionUUID->"97c9942c-c876-4d5d-89c2-f5a5e22db6a9"],
Cell[10685, 326, 1553, 40, 71, "Output",ExpressionUUID->"7a1b6c48-3382-4c2f-b8a5-d7d481c0f9c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12275, 371, 337, 8, 44, "Input",ExpressionUUID->"64c44463-2707-4b22-9253-2af5adaf9840"],
Cell[12615, 381, 172, 3, 34, "Output",ExpressionUUID->"d8b7cca9-8bab-45e3-9171-1591cc18649f"]
}, Open  ]],
Cell[12802, 387, 16162, 413, 868, "Input",ExpressionUUID->"a73a4715-5845-401d-a24e-a0398c442aa3"]
}
]
*)

(* End of internal cache information *)

